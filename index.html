<!DOCTYPE html>
<html lang="it">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Per Michelle</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://www.youtube.com/iframe_api"></script>
    <script>
        var ytPlayer = null;
        function onYouTubeIframeAPIReady() { /* pronta */ }
        function createYTPlayer() {
            ytPlayer = new YT.Player('yt-player', {
                videoId: 'LESn4LFOfes',
                playerVars: { autoplay: 1, mute: 1, rel: 0, modestbranding: 1 },
                events: {
                    onReady: function (e) {
                        e.target.playVideo();
                        setTimeout(function () { e.target.unMute(); e.target.setVolume(100); }, 1000);
                    }
                }
            });
        }
    </script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap');

        body {
            font-family: 'Playfair Display', serif;
        }

        /* Animazione caduta cuori */
        @keyframes fall {
            0% {
                transform: translateY(-10vh) rotate(0deg);
                opacity: 0;
            }

            10% {
                opacity: 0.8;
            }

            90% {
                opacity: 0.8;
            }

            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }

        .animate-fall {
            animation-name: fall;
            animation-timing-function: linear;
            animation-iteration-count: infinite;
        }

        /* Animazione entrata iframe */
        .fade-in-up {
            animation: fadeInUp 1.5s ease-out forwards;
            opacity: 0;
            transform: translateY(20px);
        }

        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>

<body class="bg-[#fffafa]">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        const App = () => {
            const [step, setStep] = useState(-1);
            const [showMain, setShowMain] = useState(false);
            const [elapsedTime, setElapsedTime] = useState({ hours: 0, minutes: 0, seconds: 0 });
            const [selectedHeart, setSelectedHeart] = useState(null);

            const startDate = new Date('2024-10-30T00:00:00');

            const introPhrases = [
                "Ciao Michelle",
                "Mi sono comportato in modo inaccettabile",
                "Ti prego perdonami",
                "Mi pento di tutto"
            ];

            // Configurazione Cuori
            const hearts = useMemo(() => Array.from({ length: 30 }).map((_, i) => ({
                id: i,
                left: Math.random() * 98,
                delay: Math.random() * 15,
                duration: 8 + Math.random() * 12,
                size: 20 + Math.random() * 25,
                img: `https://images.unsplash.com/photo-1518199266791-5375a83190b7?w=600&h=600&fit=crop&sig=${i}`
            })), []);

            useEffect(() => {
                const updateTimer = () => {
                    const now = new Date();
                    const diff = now - startDate;
                    setElapsedTime({
                        hours: Math.floor(diff / (1000 * 60 * 60)),
                        minutes: Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60)),
                        seconds: Math.floor((diff % (1000 * 60)) / 1000)
                    });
                };
                updateTimer();
                const timer = setInterval(updateTimer, 1000);
                return () => clearInterval(timer);
            }, []);

            useEffect(() => {
                if (step >= 0 && step < introPhrases.length) {
                    const timeout = setTimeout(() => setStep(prev => prev + 1), 4000);
                    return () => clearTimeout(timeout);
                } else if (step === introPhrases.length) {
                    setTimeout(() => setShowMain(true), 1000);
                }
            }, [step]);

            const handleStart = () => {
                setStep(0);
            };

            return (
                <div className="min-h-screen text-rose-900 overflow-hidden relative selection:bg-rose-200">

                    {/* Schermata Iniziale */}
                    {!showMain && (
                        <div className="fixed inset-0 bg-white z-[100] flex flex-col items-center justify-center p-6 text-center">
                            {step === -1 ? (
                                <div className="flex flex-col items-center gap-6">
                                    <div className="text-rose-500 text-6xl animate-pulse">❤️</div>
                                    <button
                                        onClick={handleStart}
                                        className="px-12 py-4 bg-rose-500 text-white rounded-full text-xl shadow-xl hover:scale-105 transition-all active:scale-95 font-sans uppercase font-bold tracking-widest cursor-pointer z-50"
                                    >
                                        Apri per Michelle
                                    </button>
                                </div>
                            ) : (
                                introPhrases.map((phrase, index) => (
                                    <div key={index} className={`absolute transition-all duration-[2000ms] text-2xl md:text-5xl font-light px-4 ${step === index ? 'opacity-100 scale-100 blur-0' : 'opacity-0 scale-90 blur-xl'}`}>
                                        {phrase}
                                    </div>
                                ))
                            )}
                        </div>
                    )}

                    {/* Contenuto Principale */}
                    <div className={`transition-opacity duration-[3000ms] ${showMain ? 'opacity-100' : 'opacity-0'}`}>

                        {/* Layer Cuori Sfondo */}
                        <div className="fixed inset-0 pointer-events-none z-0 overflow-hidden">
                            {hearts.map((h) => (
                                <div key={h.id}
                                    className="absolute animate-fall cursor-pointer pointer-events-auto hover:scale-110 transition-transform"
                                    style={{
                                        left: `${h.left}%`,
                                        animationDuration: `${h.duration}s`,
                                        animationDelay: `-${h.delay}s`,
                                        top: '-10vh'
                                    }}
                                    onClick={() => setSelectedHeart(h)}>
                                    <span style={{ fontSize: h.size }} className="opacity-40 hover:opacity-100 transition-opacity drop-shadow-sm text-rose-300">❤️</span>
                                </div>
                            ))}
                        </div>

                        <main className="relative z-10 max-w-3xl mx-auto px-6 pt-12 pb-20 text-center min-h-screen flex flex-col items-center">
                            <h1 className="text-5xl md:text-7xl font-bold mb-8 text-rose-800 tracking-tighter drop-shadow-sm">Per Michelle</h1>

                            {/* Timer Box */}
                            <div className="bg-white/60 backdrop-blur-sm rounded-3xl p-8 shadow-lg border border-rose-100 mb-12 w-full max-w-md mx-4 transform hover:scale-105 transition-transform duration-500">
                                <p className="text-[10px] uppercase tracking-[0.4em] mb-4 text-rose-500 font-bold font-sans">Il tempo con te</p>
                                <div className="flex gap-4 md:gap-6 justify-center text-4xl font-light text-rose-700">
                                    <div className="flex flex-col w-20"><span>{elapsedTime.hours}</span><span className="text-[10px] uppercase font-sans font-bold opacity-40">Ore</span></div>
                                    <div className="opacity-20 mt-1">:</div>
                                    <div className="flex flex-col w-20"><span>{elapsedTime.minutes}</span><span className="text-[10px] uppercase font-sans font-bold opacity-40">Min</span></div>
                                    <div className="opacity-20 mt-1">:</div>
                                    <div className="flex flex-col w-20"><span>{elapsedTime.seconds}</span><span className="text-[10px] uppercase font-sans font-bold opacity-40">Sec</span></div>
                                </div>
                            </div>

                            {/* Lettera */}
                            <article className="prose prose-rose text-lg leading-relaxed text-left bg-white/90 backdrop-blur-2xl p-8 md:p-12 rounded-[3rem] shadow-2xl border border-white mx-4 mb-16 w-full">
                                <h2 className="text-3xl font-serif font-bold mb-8 text-center italic text-rose-800">Per Michelle,</h2>
                                <div className="space-y-6 text-rose-950 font-serif text-xl">
                                    <p>Sei la cosa più bella che mi sia successa negli ultimi anni. Ogni volta che accade il peggio se sempre lì, con il tuo sorriso, i tuoi abbracci, le tue rassicurazioni a farmi tornare a respirare.</p>
                                    <p>Quando siamo solo io e te sembra quasi di alienarsi, scomparire e tornare ad essere libero come quando ero piccolo, come quando giocavo e nonostante le urla intorno a me io continuavo a divertirmi e vivere.</p>
                                    <p>Il tuo viso, i tuoi occhi che ancora la notte guardo mi fanno ricordare quanto io sia perso di te e di quanto tu abbia il controllo su di me più di quello che crei, di quello che credi possa passare ad altri ma nella mia testa c'è scritto solo il tuo nome. Ogni volta che mi sveglio è la tua chat la prima che guardo, è il buongiorno che ti mando la prima cosa che scrivo e la buonanotte l'ultima della giornata.</p>
                                    <p>Sono caduto tante volte, ho tanti cerotti ma credo che la metà siano i tuoi. Mi dispiace che ogni volta litighiamo, che ci bisticciamo per cose stupide ma poi quando torni a chiedermi se ti amo, quando mi dici che mi ami tanto ritorno a diventare piccolo piccolo, così piccolo da voler rimanere per sempre nei tuoi abbracci.</p>
                                    <p>Sei una persona meravigliosa, sei stupenda, intelligente, empatica, con un cuore enorme dimostrandolo non solo con me ma ogni volta che qualcuno sta male, chiunque sia, tu sei sempre lì. Sei stata sei la super eroina della mia vita, non perchè sei forte, non perchè sei invincibile ma perchè hai risollevato un caso clinico che sembrava essere irrecuperabile.</p>
                                    <p>Onestamente ti devo la mia vita, perchè dopo l'ultimo anno senza di te sarei stato soltanto un morto che cammina. Ricordo ancora ogni notte: la prima in cui io mi misi a piangere sul divano perchè non riuscivo a credere che tu mi stessi imboccando, quella alle scale in cui mi misi a piangere nelle tue braccia perchè non riuscivo a credere che tu mi stessi facendo vedere la torta che mi avevi fatto e ancora tutte le altre come quella in cui sei venuta a casa con quel vestito con cui mi hai completamente ipnotizzato.</p>
                                    <p>Sei veramente una stella. Emani luce tua irradiando tutto quello che ti circonda e facendolo diventare meraviglio, caduta dal cielo perchè la terra non ti appartiene, sei troppo unica, troppo meravigliosa, troppo splendente.</p>
                                    <p>Sei la cosa più bella che mi sia successa in tutta la mia vita. Non so se vorrai mai tornare con me però ti prego ti chiedo una cosa. Io ho visto chi sei veramente, quanto vali e quanto sei meravigliosa. Forse è un bene che ci siamo trovati così. Non mi fraintendere, sono preso malissimo per tutto quello che ho detto e fatto, ma sopratutto per averti ferito e averti fatto sentire così male. Però tu devi essere felice, devi stare bene e forse io non ti ho fatto più sentire così.</p>
                                    <p>Prego veramente con il cuore che se non posso essere io, sia qualcun'altro a farti sentire bene, fortunata, libera come ti meriti, senza pensieri senza problemi. Vorrei che ti cucinasse, che ti regali i fiori nei giorni in cui sei triste e che sappia che dovrebbe comprare anche i baci perugina perchè sei una golosona. Vorrei che ti regalasse i tulipani, quelli che io non ho mai potuto regalarti perchè a quella merda di Cosenza non li trovo mai, ma prima o poi li riceverai, come riceverai veramente quella persona.</p>
                                    <p>Ho veramente il terrore nello scrivere queste cose, ma io mi pento di tutto e tu fai bene ad esserti allontanata, ti ho fatto soffrire tanto e non te lo meritavi. Ho fatto prevalere i miei incubi, le mie paura e ti ho attaccata. Se non rimarrò con te sarai il mio più grande pentimento.</p>
                                    <p>Ho passato tutto il giorno a rifletterci, a ripensarci e a piangere come un ritardato, consapevole di quello che ho fatto ma sapendo anche che non giustificava niente. Questo è solo un altro modo solo per comunicarti quanto mi dispiaccia e che tu conti veramente per me.</p>
                                    <p>Non ti sto chiedendo di tornare con me, però se un giorno vorrai riparlare con me io sarò la persona più felice di questo mondo a riascoltarti, riabbracciarti, vederti e sentirti ridere, nasconderci, correre via, riprenderci e ripassare il mio compleanno alle scale che sono state testimoni di quasi tutta la nostra storia, quella più bella della mia vita.</p>
                                    <p>Non c'è un giorno in cui io mi sono pentito per aver fatto quella strada di notte dopo esser stato conte, averti baciata e abbracciata, fatto le coccole e tanto altro. Sei stato il regalo più bello Michelle.</p>
                                    <p>Mi sveglierò di notte come ho sempre fatto in questo anno consapevole che tu non sei con me e rattristandomi ma ricordandomi di avere il privilegio di aver amato ed esser stato amato veramente da una persona che mi ha fatto sentire unico e speciale.</p>
                                    <p>Ti auguro il meglio, ti auguro una vita meravigliosa e aspetto e spero che tu possa in un momento volermi scrivere un messaggio che potrebbe cambiarmi di nuovo la vita come hai fatto tante volte tu senza saperlo.</p>
                                    <p>Io ti amo e ti amerò per sempre e se dovessimo chiudere sappi che se dovessimo rivederci e io ti guarderò saprai che provo ancora sentimenti forti per te.</p>
                                </div>
                                <div className="text-right font-bold mt-12 text-rose-600 italic text-2xl">

                                </div>
                            </article>

                            {/* Video Youtube CON AUDIO */}
                            {showMain && (
                                <div className="w-full max-w-2xl fade-in-up" style={{ animationDelay: '1s' }} ref={(el) => { if (el && !window._ytCreated) { window._ytCreated = true; setTimeout(createYTPlayer, 500); } }}>
                                    <div className="relative w-full aspect-video rounded-[2rem] overflow-hidden shadow-2xl border-4 border-white bg-black">
                                        <div id="yt-player" style={{ width: '100%', height: '100%' }}></div>
                                    </div>
                                </div>
                            )}

                        </main>
                    </div>

                    {/* Modal Cuore Click */}
                    {selectedHeart && (
                        <div className="fixed inset-0 z-[200] bg-rose-950/40 backdrop-blur-md flex items-center justify-center p-4 transition-all" onClick={() => setSelectedHeart(null)}>
                            <div className="bg-white rounded-[2rem] overflow-hidden max-w-sm w-full shadow-2xl transform transition-all scale-100" onClick={e => e.stopPropagation()}>
                                <div className="relative h-64 overflow-hidden">
                                    <img src={selectedHeart.img} className="w-full h-full object-cover" />
                                    <button onClick={() => setSelectedHeart(null)} className="absolute top-4 right-4 bg-white/80 p-2 rounded-full text-rose-900 font-bold shadow-md hover:bg-white">✕</button>
                                </div>
                                <div className="p-8 text-center bg-white">
                                    <div className="text-rose-500 mb-4 text-4xl">❤️</div>
                                    <p className="text-rose-900 italic text-xl font-serif">"Sei la cosa più bella che ho."</p>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>

</html>
